<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Token Gated Page ‚Äì ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì Holder</title>
</head>
<body>
  <h2>üîê Token Gated Example</h2>

  <div id="content" style="display:none;">
    <h3>üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢ ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©!</h3>
    <p>‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ Secret Content ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ‡∏î‡πâ‡∏ß‡∏¢ Unlock Protocol.</p>
    <p><a href="https://bafybeigsrytimlmv4dkz2px7ke4bwco4qj2kgxsdaeaxgmvkubiuexh5cu.ipfs.w3s.link" target="_blank">üëâ Test Link</a></p>
  </div>

  <div id="locked">
    <button id="connect">üîë Connect Wallet</button>
    <p>‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ Membership Key ‡∏à‡∏≤‡∏Å Lock ‡∏ô‡∏µ‡πâ‡∏à‡∏∂‡∏á‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ</p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    // üîí Contract ERC-721 (Collection)
    const contractAddress = "0x76f4E59DBBF99D025B6F1014D33843AB138e4085";
    const network = "matic"; // Polygon Mainnet

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö token ‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï
    const allowedTokenIds = Array.from({length: 11}, (_, i) => i); // [0..10]

    async function checkMembership() {
      if (typeof window.ethereum === "undefined") {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
        return;
      }

      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = provider.getSigner();
      const userAddress = await signer.getAddress();

      const abi = [
        "function ownerOf(uint256 tokenId) external view returns (address)"
      ];
      const contract = new ethers.Contract(contractAddress, abi, provider);

      let hasAccess = false;
      for (let tokenId of allowedTokenIds) {
        try {
          const owner = await contract.ownerOf(tokenId);
          if (owner.toLowerCase() === userAddress.toLowerCase()) {
            hasAccess = true;
            break;
          }
        } catch (e) {
          // token ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ mint
        }
      }

      if (hasAccess) {
        document.getElementById("locked").style.display = "none";
        document.getElementById("content").style.display = "block";
      } else {
        alert("‚ùå ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Token ID 0-10 ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö");
      }
    }

    document.getElementById("connect").addEventListener("click", checkMembership);
  </script>
</body>
</html>
